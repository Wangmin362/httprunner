config:
  verify: False
  variables:
    base_url: https://${ENV(endpoint)}
    popId: 4d4bb819-6a01-471d-8ea2-cda7e4882283
    popCode: f5bcee3047718ee25d0e02df
    xTenantId: ${GetTenantId()}
    xTimestamp: ${GetCurrentTimestamp()}
    authorization: ${GetAuth($xTenantId, $popCode, $popId, $xTimestamp)}
  headers:
    Content-Type: application/json
    x-tenant-id: ${xTenantId}
    x-timestamp: ${xTimestamp}
    x-pop-id: ${popId}
    Authorization: ${authorization}

teststeps:
  - name: "[sps] Get tenant list"
    request:
      method: GET
      url: $base_url/skgwSps/sps/v1/tenant/list
    validate:
      - eq: ["status_code", 200]

  - name: "[sps Get dlp policy currentversion"
    request:
      method: GET
      url: $base_url/skgwSps/sps/v1/dlp/policy/currentVersion
    extract:
      version: "body.data"
    validate:
      - eq: ["status_code", 200]

  - name: "[sps] Get dlp policy"
    request:
      method: GET
      url: $base_url/skgwSps/sps/v1/dlp/policy/${version}
    validate:
      - eq: ["status_code", 200]

